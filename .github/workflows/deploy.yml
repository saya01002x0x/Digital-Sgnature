name: CD - Deploy to Render

on:
  push:
    branches: ['main']  

jobs:
  notify-deployment:
    name: Notify Deployment Started
    runs-on: ubuntu-latest
    
    steps:
      - name: üöÄ Deployment triggered
        run: |
          echo "Deployment to Render started!"
          echo "Branch: ${{ github.ref_name }}"
          echo "Commit: ${{ github.sha }}"
          echo "Author: ${{ github.actor }}"
      
      # Optional: Th√™m notification ƒë·∫øn Discord/Slack n·∫øu c·∫ßn
      # - name: Send notification
      #   uses: ...

  # Render s·∫Ω t·ª± ƒë·ªông deploy khi detect push v√†o main
  # N·∫øu mu·ªën trigger th·ªß c√¥ng, c√≥ th·ªÉ d√πng Render Deploy Hook
  trigger-render-deploy:
    name: Trigger Render Deployment
    runs-on: ubuntu-latest
    needs: notify-deployment
    
    steps:
      - name: üì¶ Trigger Render Deploy Hook
        if: github.ref == 'refs/heads/main'
        run: |
          if [ -n "${{ secrets.RENDER_DEPLOY_HOOK_URL }}" ]; then
            echo "üöÄ Triggering Render Deploy Hook..."
            curl -X POST ${{ secrets.RENDER_DEPLOY_HOOK_URL }}
          else
            echo "‚ÑπÔ∏è RENDER_DEPLOY_HOOK_URL not set, relying on Render auto-deploy."
          fi
